"use strict";(self.webpackChunkdialer_app=self.webpackChunkdialer_app||[]).push([[596],{2634:function(e,n,i){i(2791);n.Z=i.p+"static/media/searchicon.6bec5882e84ffe20b7fd011c414f7272.svg"},1141:function(e,n,i){i.r(n),i.d(n,{default:function(){return y}});var t=i(4165),l=i(5861),c=i(885),a=i(2791),s=i(6871),r=i.p+"static/media/incoming.50c6adeaccb3c3152cf9.mp3",o=i(8986),u=i(4261),d=i(2426),v=i.n(d),p=i(9434);var m=i.p+"static/media/logout.0b8e7fd759a37d46acd1c4f27e0d6a4b.svg";var f=i.p+"static/media/homeBtn.b29e16ab48e88feac291eac49c04e544.svg";var x=i.p+"static/media/phoneImage.d0a1c41a48a86050bc48b4350dfb682e.svg";var h=i.p+"static/media/contact.0e2c4004722e6c4b71ca7d3131fa3044.svg";var N=i.p+"static/media/knowledge.d6ac7c3807b855f08d5035a9a2089729.svg";var g=i.p+"static/media/reportImage.26fb0e4fe9a667325f8ab8756abe2f7e.svg";var b=i.p+"static/media/setting.50f7d53cc61bc7e9e0013cc043c02aec.svg",j=i(5174),A=[{id:"adminWidgetNav",title:"Widget",link:j.Su.ADMIN.PAGES.WIDGET,icon:"",className:""},{id:"adminAgentNav",title:"Agents",link:j.Su.ADMIN.PAGES.AGENTS,icon:"",className:""},{id:"adminDepartmentNav",title:"Department",link:j.Su.ADMIN.PAGES.DEPARTMENT,icon:"",className:""}],k=[{id:"homeButtonNav",title:"Overview",link:j.Su.ADMIN.PAGES.DASHBOARD,icon:f,className:""},{id:"callImageNav",title:"Call Details",link:j.Su.ADMIN.PAGES.CALL_LOGS,icon:x,className:""},{id:"contactNav",title:"Contacts",link:j.Su.ADMIN.PAGES.CONTACTS,icon:h,className:""},{id:"knowledgeNav",title:"Knowledge Base",link:j.Su.ADMIN.PAGES.KNOWLEDGE,icon:N,className:""},{id:"reportNav",title:"Reports",link:j.Su.ADMIN.PAGES.REPORTS,icon:g,className:""},{id:"adminNav",title:"Admin View",icon:b,className:"",subNav:A}],S=[{id:"homeButtonNav",title:"Overview",link:j.Su.AGENT.PAGES.DASHBOARD,icon:f,className:""},{id:"callImageNav",title:"Call Details",link:j.Su.AGENT.PAGES.CALL_LOGS,icon:x,className:""},{id:"contactNav",title:"Contacts",link:j.Su.AGENT.PAGES.CONTACTS,icon:h,className:""},{id:"knowledgeNav",title:"Knowledge Base",link:j.Su.AGENT.PAGES.KNOWLEDGE,icon:N,className:""},{id:"reportNav",title:"Reports",link:j.Su.AGENT.PAGES.REPORTS,icon:g,className:""}],E=k,F=i(1829),w=i(6579),T=i(5290),R=i(184),D=function(){var e=(0,s.s0)(),n=(0,s.TH)(),i=(0,p.I0)(),t=(0,w.C)((function(e){return e.user})),l=t.user;t.isAuthenticated;return(0,R.jsxs)("div",{className:"left-panel bg-[#FFFFFF] w-[235px] border-r-[1px] border-solid border-[#E7E7E7] shadow-md px-[20px] pt-[40px] h-[100%]",children:[(0,R.jsx)("h3",{className:"text-[#3372D1] text-[36px]",children:"CallerCloud"}),(0,R.jsxs)("ul",{className:"mt-[53px] h-[100%]",children:[(null===l||void 0===l?void 0:l.userType)===T.Z.ADMIN&&E.map((function(i,t){return(0,R.jsxs)("li",{className:"",onClick:function(){return(null===i||void 0===i?void 0:i.link)&&e("".concat(i.link))},children:[(0,R.jsxs)("div",{className:"inline-flex h-[19px] gap-[18px] mb-[30px]",children:[(0,R.jsx)("i",{className:"items-center",children:(0,R.jsx)("img",{src:null===i||void 0===i?void 0:i.icon})}),(0,R.jsx)("span",{className:"".concat((i.link?n.pathname.includes(i.link):null===E||void 0===E?void 0:E.find((function(e){var i;return null===e||void 0===e||null===(i=e.subNav)||void 0===i?void 0:i.find((function(e){return n.pathname.includes(e.link)}))})))?"flex items-center px-3 cursor-pointer gap-4  mb-5 h-10 bg-blue-50 border-l-4 border-blue-500 rounded-md transition-colors duration-200":"text-base text-[#8F8F8F] inline-flex h-[19px] gap-[18px] mb-7 transition-colors duration-200 cursor-pointer"),children:null===i||void 0===i?void 0:i.title})]}),(null===i||void 0===i?void 0:i.subNav)&&(0,R.jsx)("ul",{className:"mt-0 ml-3 pl-7 border-l-2",children:i.subNav.map((function(i,t){return(0,R.jsx)("li",{className:"my-4 cursor-pointer",onClick:function(n){n.stopPropagation(),i.link&&e("".concat(i.link))},children:(0,R.jsxs)("span",{className:"text-[16px] text-[".concat(n.pathname.includes(i.link)?"#3e8cff":"#8F8F8F","]"),children:[(0,R.jsx)("i",{className:"items-center",children:(0,R.jsx)("img",{src:null===i||void 0===i?void 0:i.icon})}),(0,R.jsx)("span",{className:"text-[16px] text-[".concat(n.pathname.includes(i.link)?"#3e8cff":"#8F8F8F","]"),children:null===i||void 0===i?void 0:i.title})]})},t)}))})]},t)})),(null===l||void 0===l?void 0:l.userType)===T.Z.AGENT&&S.map((function(i,t){return(0,R.jsxs)("li",{className:"",onClick:function(){return(null===i||void 0===i?void 0:i.link)&&e("".concat(i.link))},children:[(0,R.jsxs)("div",{className:"inline-flex h-[19px] gap-[18px] mb-[30px]",children:[(0,R.jsx)("i",{className:"items-center",children:(0,R.jsx)("img",{src:null===i||void 0===i?void 0:i.icon})}),(0,R.jsx)("span",{className:"".concat((i.link?n.pathname.includes(i.link):null===E||void 0===E?void 0:E.find((function(e){var i;return null===e||void 0===e||null===(i=e.subNav)||void 0===i?void 0:i.find((function(e){return n.pathname.includes(e.link)}))})))?"flex items-center px-3 cursor-pointer gap-4  mb-5 h-10 bg-blue-50 border-l-4 border-blue-500 rounded-md transition-colors duration-200":"text-base text-[#8F8F8F] inline-flex h-[19px] gap-[18px] mb-7 transition-colors duration-200 cursor-pointer"),children:null===i||void 0===i?void 0:i.title})]}),(null===i||void 0===i?void 0:i.subNav)&&(0,R.jsx)("ul",{className:"mt-0 ml-3 pl-7 border-l-2",children:i.subNav.map((function(i,t){return(0,R.jsx)("li",{className:"my-4 cursor-pointer",onClick:function(n){n.stopPropagation(),i.link&&e("".concat(i.link))},children:(0,R.jsxs)("span",{className:"text-[16px] text-[".concat(n.pathname.includes(i.link)?"#3e8cff":"#8F8F8F","]"),children:[(0,R.jsx)("i",{className:"items-center",children:(0,R.jsx)("img",{src:null===i||void 0===i?void 0:i.icon})}),(0,R.jsx)("span",{className:"text-[16px] text-[".concat(n.pathname.includes(i.link)?"#3e8cff":"#8F8F8F","]"),children:null===i||void 0===i?void 0:i.title})]})},t)}))})]},t)})),(0,R.jsx)("li",{className:"",onClick:function(){i((0,F.kS)(null===l||void 0===l?void 0:l.userType))},children:(0,R.jsxs)("div",{className:"inline-flex h-[19px] gap-[18px] mb-[30px]",children:[(0,R.jsx)("i",{className:"items-center",children:(0,R.jsx)("img",{src:m})}),(0,R.jsx)("span",{className:' text-base text-[#8F8F8F] inline-flex h-[19px] gap-[18px] mb-7 transition-colors duration-200 cursor-pointer"\n                ',children:"Logout"})]})})]})]})};var G=i.p+"static/media/bellicon.9606645dbff78a8aac31184a6ae71c3e.svg",C=(i(2634),function(){var e,n,i,t=JSON.parse(localStorage.getItem("user")),l=null===t||void 0===t?void 0:t.userName,c=((0,s.s0)(),(0,s.TH)()),a=null!==(e=null===E||void 0===E||null===(n=E.find((function(e){return c.pathname.includes(e.link)})))||void 0===n?void 0:n.title)&&void 0!==e?e:null===E||void 0===E||null===(i=E.find((function(e){var n;return null===e||void 0===e||null===(n=e.subNav)||void 0===n?void 0:n.find((function(e){return c.pathname.includes(e.link)}))})))||void 0===i?void 0:i.title;return(0,R.jsxs)("nav",{className:"w-full shadow-md py-10 px-4 flex justify-between items-center",children:[(0,R.jsx)("div",{className:"flex items-center",children:(0,R.jsx)("h1",{className:" font-medium text-2xl",children:a})}),(0,R.jsxs)("div",{className:"flex items-center gap-6 h-12",children:[(0,R.jsx)("h2",{children:l}),(0,R.jsx)("div",{className:"notification",children:(0,R.jsx)("img",{src:G,alt:"notification icon",className:"h-6"})}),(0,R.jsx)("div",{className:"profile-image",children:(0,R.jsx)("img",{src:"https://images.unsplash.com/photo-1575936123452-b67c3203c357?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8aW1hZ2V8ZW58MHx8MHx8fDA%3D&w=1000&q=80",alt:"profile",className:"h-9 rounded-lg"})})]})]})}),P=i(4126),Z=i(5953),y=function(){var e,n,i=(0,s.TH)(),d=(0,a.useRef)(new Audio(r)),p=JSON.parse(null===(e=localStorage)||void 0===e?void 0:e.getItem("user")),m=(0,w.C)((function(e){return e.user})),f=m.user,x=m.isAuthenticated,h=(0,a.useState)(),N=(0,c.Z)(h,2),g=N[0],b=N[1],A=(0,a.useState)(!1),k=(0,c.Z)(A,2),S=k[0],E=k[1],F=(0,a.useState)(!1),G=(0,c.Z)(F,2),y=G[0],I=G[1],M=null===p||void 0===p?void 0:p.peerId,O=navigator.mediaDevices.getUserMedia,B=(0,s.s0)(),H=(0,a.useRef)(null),L=(0,a.useRef)(null),_=(0,a.useRef)(null),W=(0,a.useRef)(null),K=(0,a.useRef)(null),J=(0,a.useRef)(null),V=(0,a.useRef)(null),q=(0,a.useRef)(""),z=(0,a.useRef)(null),U=(0,a.useRef)(null),Y=(0,a.useRef)(null),Q=(0,a.useRef)(null),X=(0,a.useRef)(!1);(0,a.useEffect)((function(){window.scrollTo(0,0)}),[null===i||void 0===i?void 0:i.pathname]),(0,a.useEffect)((function(){(null===f||void 0===f?void 0:f.userType)!==T.Z.ADMIN&&(null===f||void 0===f?void 0:f.userType)!==T.Z.AGENT&&B(x?j.pn.ERROR_403:j.Bp.BASE_PATH)}),[null===f||void 0===f?void 0:f.userType,x]);var $=function(e){_.current=new Audio,_.current.srcObject=e,_.current.play()},ee=function(e){"close_call"===e.type&&(J.current.close(),b(""),d.current.pause())},ne=function(e){var n,i,t;b("ringing"),z.current=null===e||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.name,U.current=null===e||void 0===e||null===(i=e.metadata)||void 0===i?void 0:i.phone,Y.current=null===p||void 0===p?void 0:p.useName,Q.current=null===e||void 0===e||null===(t=e.metadata)||void 0===t?void 0:t.department,q.current=(0,u.Z)().split("-").shift().slice(0,6),K.current=e,V.current=v()().format("HH:mm:ss"),d.current.loop=!0,d.current.play(),e.on("stream",$),e.on("close",(function(){console.log("call ended")}))},ie=function(){var e=(0,l.Z)((0,t.Z)().mark((function e(){var n,i,l;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=v()(),i=v().duration(n.diff(V.current)),l=v().utc(i.asMilliseconds()).format("mm:ss"),e.next=5,Z.Z.updateCallDetails({duration:l,callStatus:"available"},H.current).then((function(e){B("/auth/login"),d.current.pause()})).catch((function(e){console.log("error in closing")}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,a.useEffect)((function(){if("ringing"===g){var e=function(){var e=(0,l.Z)((0,t.Z)().mark((function e(){var n,i;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Z.Z.saveCallDetails({from:z.current,to:null===p||void 0===p?void 0:p.userName,callStatus:"calling",department:Q.current,time:V.current,ticket:q.current});case 3:i=e.sent,H.current=null===i||void 0===i||null===(n=i.data)||void 0===n?void 0:n.id,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e(),X.current=!0}}),[g,null===p||void 0===p?void 0:p.userName]),(0,a.useEffect)((function(){return W.current=new o.ZP(M,{host:"0.peerjs.com",port:443,path:"/",pingInterval:5e3}),W.current.on("open",(function(e){O({video:!1,audio:!0}).then((function(e){L.current=e,W.current.on("connection",(function(e){J.current=e,e.on("data",ee),W.current.on("call",ne),e.on("close",ie)}))})),W.current.on("close",(function(){console.log("peer is closed"),d.current.pause()})),W.current.on("error",(function(e){console.log("could not establish a peer connection successfully due to ",e)})),W.current.on("disconnected",(function(){console.log("peer connection is disconnected")}))})),function(){W.current.disconnect(),W.current.destroy()}}),[M]),(null===(n=i.pathname.split("/"))||void 0===n?void 0:n[1])!==f.userType?(0,R.jsx)(s.Fg,{to:x?j.pn.ERROR_403:j.Bp.BASE_PATH}):(0,R.jsx)(R.Fragment,{children:(0,R.jsxs)("section",{className:"flex h-[100%] w-[100%] relative overflow-x-hidden",children:["ringing"===g&&(0,R.jsx)(P.default,{onAcceptClick:function(){K.current.answer(L.current),d.current.pause(),d.current.currentTime=0,E(!S),I(!y)},onRejectClick:function(){K.current.close(),J.current.close(),b("")},disconnect:function(){K.current.close(),J.current.close(),b(""),B("/auth/login"),d.current.pause()},expanded:S,accepted:y,setExpanded:E,setAccepted:I,ticket:q.current,name:z.current,phone:U.current}),(0,R.jsx)("div",{className:"left-panel bg-[#FFFFFF] w-[235px] ",children:(0,R.jsx)(D,{})}),(0,R.jsxs)("div",{className:"right-panel w-full h-[100vh] max-h-[100vh] overflow-y-scroll",children:[(0,R.jsx)("div",{className:"top-header",children:(0,R.jsx)(C,{})}),(0,R.jsx)("div",{className:"content-section relative",children:(0,R.jsx)(s.j3,{})})]})]})})}}}]);
//# sourceMappingURL=596.14080761.chunk.js.map